Description: denial of service and possible code execution via crafted tags
Origin: upstream, http://libexif.cvs.sourceforge.net/viewvc/libexif/libexif/libexif/exif-utils.c?r1=1.16&r2=1.17&view=patch
Bug-Ubuntu: https://bugs.launchpad.net/ubuntu/+source/libexif/+bug/1024213
Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=681454

Index: libexif-0.6.20/libexif/exif-utils.c
===================================================================
--- libexif-0.6.20.orig/libexif/exif-utils.c	2010-10-15 01:56:54.000000000 -0400
+++ libexif-0.6.20/libexif/exif-utils.c	2012-07-19 13:16:49.666149022 -0400
@@ -239,7 +239,7 @@
 				break;
 			}
 		} else {
-			if (maxlen > 2) {
+			if (maxlen > 3) {
 				*out++ = ((*in >> 12) & 0x0F) | 0xE0;
 				*out++ = ((*in >> 6) & 0x3F) | 0x80;
 				*out++ = (*in++ & 0x3F) | 0x80;
