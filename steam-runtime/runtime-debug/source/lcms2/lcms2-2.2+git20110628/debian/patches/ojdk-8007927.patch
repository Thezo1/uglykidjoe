# HG changeset patch
# User bae
# Date 1363852330 -14400
# Node ID 4047e9efcbd0966d8cc15d51f9b25ae5b141e239
# Parent  a7299af2af32c38eef541180e26f4aac7d79bff8
8007927: Improve cmsAllocProfileSequenceDescription

Index: lcms2-2.2+git20110628/src/cmsnamed.c
===================================================================
--- lcms2-2.2+git20110628.orig/src/cmsnamed.c	2013-07-01 11:02:26.000000000 -0500
+++ lcms2-2.2+git20110628/src/cmsnamed.c	2013-07-01 11:03:56.000000000 -0500
@@ -698,6 +702,10 @@
     Seq -> seq      = (cmsPSEQDESC*) _cmsCalloc(ContextID, n, sizeof(cmsPSEQDESC));
     Seq -> n        = n;
 
+    if (Seq -> seq == NULL) {
+        _cmsFree(ContextID, Seq);
+	return NULL;
+    }
     
     for (i=0; i < n; i++) {
         Seq -> seq[i].Manufacturer = NULL;
